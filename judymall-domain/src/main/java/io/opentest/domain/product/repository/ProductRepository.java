/*
 * Copyright 2019. OPENTEST. All rights reserved.
 */

package io.opentest.domain.product.repository;

import com.querydsl.core.BooleanBuilder;
import com.querydsl.jpa.impl.JPAQueryFactory;
import io.opentest.domain.AbstractRepository;
import io.opentest.domain.product.entity.Product;
import io.opentest.domain.product.entity.QProduct;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Repository;

import java.util.List;

@Slf4j
@Repository
public class ProductRepository extends AbstractRepository<Product, Long> {

    public ProductRepository() {
        setClazz(Product.class);
    }

    /**
     * 상품 목록을 가져온다.
     */
    public List<Product> findAll() {

        JPAQueryFactory queryFactory = new JPAQueryFactory(entityManager());
        QProduct product = QProduct.product;
        BooleanBuilder builder = new BooleanBuilder();

        return queryFactory.selectFrom(product)
                .where(builder)
                //.groupBy()
                //.orderBy()
                //.offset(0)
                //.limit(10)
                .fetch();
    }
}
